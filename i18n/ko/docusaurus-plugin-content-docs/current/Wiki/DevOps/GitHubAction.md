# GitHub Actions

## 개요
GitHub Actions는 지속적인 통합과 지속적인 배포(CI/CD) 플랫폼으로, 빌드, 테스트 및 배포 파이프라인을 자동화할 수 있게 한다. 저장소에 대한 모든 풀 리퀘스트를 빌드하고 테스트하는 워크플로우를 생성하거나, 병합된 풀 리퀘스트를 프로덕션에 배포할 수 있다.

GitHub Actions는 DevOps를 넘어, 저장소에서 다른 이벤트가 발생할 때도 워크플로우를 실행할 수 있게 한다. 예를 들어, 누군가 새로운 이슈를 생성할 때마다 자동으로 적절한 라벨을 추가하는 워크플로우를 실행할 수 있다.

GitHub는 워크플로우를 실행하기 위해 Linux, Windows, macOS 가상 머신을 제공하며, 자체 데이터 센터나 클라우드 인프라에서 자체 호스팅된 러너를 사용할 수도 있다.

## GitHub Actions의 구성 요소
GitHub Actions 워크플로우는 저장소에서 이벤트가 발생할 때 트리거되도록 구성할 수 있다. 예를 들어, 풀 리퀘스트가 생성되거나 이슈가 생성될 때 트리거된다. 워크플로우에는 순차적으로 또는 병렬로 실행되는 하나 이상의 작업이 포함된다. 각 작업은 자체 가상 머신 러너 또는 컨테이너 내에서 실행되며, 정의한 스크립트를 실행하거나, 워크플로우를 단순화할 수 있는 재사용 가능한 확장인 액션을 실행하는 한 개 이상의 단계로 구성된다.

### 워크플로우
워크플로우는 하나 이상의 작업을 실행하는 설정 가능한 자동화 프로세스이다. 워크플로우는 저장소에 체크인된 YAML 파일로 정의되며, 저장소에서 이벤트에 의해 트리거되거나 수동으로 또는 정의된 일정에 따라 실행될 수 있다.

워크플로우는 저장소의 `.github/workflows` 디렉토리에 정의되며, 각 저장소에는 서로 다른 작업을 수행하는 여러 워크플로우가 있을 수 있다. 예를 들어, 풀 리퀘스트를 빌드하고 테스트하는 워크플로우, 릴리스가 생성될 때 애플리케이션을 배포하는 워크플로우, 누군가 새로운 이슈를 생성할 때마다 라벨을 추가하는 워크플로우 등을 설정할 수 있다.

### 이벤트
이벤트는 워크플로우 실행을 트리거하는 특정 활동이다. 예를 들어, 누군가가 풀 리퀘스트를 생성하거나 이슈를 생성하거나 커밋을 저장소에 푸시할 때 발생할 수 있다. 또한 워크플로우를 일정에 따라 실행하거나, REST API에 게시하여 실행하거나, 수동으로 트리거할 수도 있다.

### 작업 (Jobs)
작업은 같은 러너에서 실행되는 워크플로우의 일련의 단계이다. 각 단계는 실행될 쉘 스크립트이거나, 실행할 액션이다. 단계는 순서대로 실행되며, 서로 의존적이다. 각 단계는 같은 러너에서 실행되므로 한 단계에서 다른 단계로 데이터를 공유할 수 있다. 예를 들어, 애플리케이션을 빌드하는 단계 다음에 빌드된 애플리케이션을 테스트하는 단계를 가질 수 있다.

작업 간의 의존성을 구성할 수 있으며, 기본적으로 작업은 의존성이 없으며 서로 병렬로 실행된다. 한 작업이 다른 작업에 의존할 때, 의존 작업이 완료된 후에만 실행된다. 예를 들어, 의존성이 없는 서로 다른 아키텍처에 대한 여러 빌드 작업이 있고, 이 작업들이 완료되면 패키징 작업이 실행될 수 있다.

### 액션
액션은 GitHub Actions 플랫폼을 위한 사용자 정의 애플리케이션으로, 자주 반복되는 복잡한 작업을 수행한다. 액션을 사용하면 워크플로우 파일에서 작성하는 반복적인 코드를 줄일 수 있다. 액션은 GitHub에서 git 저장소를 가져오고, 빌드 환경에 맞는 올바른 툴체인을 설정하거나, 클라우드 제공자에 대한 인증을 설정할 수 있다.

자신의 액션을 작성하거나, GitHub Marketplace에서 워크플로우에 사용할 액션을 찾을 수 있다.

### 러너
러너는 워크플로우가 트리거될 때 워크플로우를 실행하는 서버이다. 각 러너는 한 번에 하나의 작업을 실행할 수 있다. GitHub는 Ubuntu Linux, Microsoft Windows 및 macOS 러너를 제공하여 워크플로우를 실행한다. 각 워크플로우 실행은 새로 프로비저닝된 가상 머신에서 실행된다. GitHub는 또한 더 큰 구성의 러너를 제공한다. 자세한 내용은 "더 큰 러너에 대해"를 참조한다. 다른 운영 체제나 특정 하드웨어 구성이 필요한 경우, 자체 호스팅된 러너를 사용할 수 있다.

## 예제 워크플로우 생성
GitHub Actions는 YAML 구문을 사용하여 워크플로우를 정의한다. 각 워크플로우는 `.github/workflows` 디렉토리 내에 저장된 별도의 YAML 파일로 관리된다.

코드가 푸시될 때마다 명령어 시리즈를 자동으로 트리거하는 예제 워크플로우를 생성할 수 있다. 이 워크플로우에서 GitHub Actions는 푸시된 코드를 체크아웃하고, bats 테스트 프레임워크를 설치하며, 기본 명령어를 실행하여 bats 버전을 출력한다: `bats -v`.

저장소 내에 `.github/workflows/` 디렉토리를 생성하여 워크플로우 파일을 저장한다.

`.github/workflows/` 디렉토리 내에 `learn-github-actions.yml`이라는 새 파일을 생성하고 아래 코드를 추가한다.

```yaml
name: learn-github-actions
run-name: ${{ github.actor }} is learning GitHub Actions
on: [push]
jobs:
  check-bats-version:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: npm install -g bats
      - run: bats -v
```

이 변경 사항을 커밋하고 GitHub 저장소에 푸시한다.

새 GitHub Actions 워크플로우 파일이 저장소에 설치되었으며, 누군가 저장소에 변경 사항을 푸시할 때마다 자동으로 실행된다. 워크플로우 실행 기록에 대한 자세한 내용을 보려면 "워크플로우 실행 기록 보기"를 참조한다.

## 워크플로우 파일 이해
YAML 구문이 워크플로우 파일을 생성하는 데 어떻게 사용되는지 이해하기 위해, 예제의 각 줄을 설명한다.

```yaml
name: learn-github-actions
```
- 선택 사항 - GitHub 저장소의 "Actions" 탭에 표시될 워크플로우의 이름이다. 이 필드를 생략하면 워크플로우 파일의 이름이 대신 사용된다.

```yaml
run-name: ${{ github.actor }} is learning GitHub Actions
```
- 선택 사항 - 워크플로우에서 생성된 워크플로우 실행의 이름으로, 저장소의 "Actions" 탭에 있는 워크플로우 실행 목록에 표시된다. 이 예제에서는 `github` 컨텍스트를 사용하여 워크플로우 실행을 트리거한 사용자의 이름을 표시한다. 자세한 내용은 "GitHub Actions를 위한 워크플로우 구문"을 참조한다.

```yaml
on: [push]
```
- 이 워크플로우의 트리거를 지정한다. 이 예제에서는 `push` 이벤트를 사용하므로, 누군가 저장소에 변경 사항을 푸시하거나 풀 리퀘스트를 병합할 때마다 워크플로우가 트리거된다. 이는 모든 브랜치에 대한 푸시를 트리거한다. 

```yaml
jobs:
```
- `learn-github-actions` 워크플로우에서 실행되는 모든 작업을 그룹화한다.

```yaml
  check-bats-version:
```
- `check-bats-version`이라는 작업을 정의한다. 하위 키는 작업의 속성을 정의한다.

```yaml
    runs-on: ubuntu-latest
```
- 작업을 최신 버전의 Ubuntu Linux 러너에서 실행하도록 구성한다. 이는 작업이 GitHub에서 호스팅하는 새 가상 머신에서 실행됨을 의미한다.

```yaml
    steps:
```
- `check-bats-version` 작업에서 실행되는 모든 단계를 그룹화한다. 이 섹션에 중첩된 각 항목은 별도의 액션 또는 쉘 스크립트이다.

```yaml
      - uses: actions/checkout@v4
```
- `uses` 키워드는 이 단계가 `actions/checkout` 액션의 v4를 실행함을 지정한다. 이는 저장소를 러너로 체크아웃하는 액션으로, 코드에 대해 스크립트나 다른 액션(예: 빌드 및 테스트 도구)을 실행할 수 있게 한다. 저장소의 코드를 사용할 경우 체크아웃 액션을 사용해야 한다.

```yaml
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
```
- 이 단계는 `actions/setup-node@v4` 액션을 사용하여 지정된 버전의 Node.js를 설치한다. (이 예제에서는 버전 20을 사용한다.) 이는 `node`와 `npm` 명령을 `PATH`에 추가한다.

```yaml
      - run: npm install -g bats
```
- `run` 키워드는 러너에서 명령을 실행하도록 작업에 지시한다. 이 경우, `npm`을 사용하여 `bats` 소프트웨어 테스트 패키지를 설치한다.

```yaml
      - run: bats -v
```
- 마지막으로 `bats` 명령을 실행하여 소프트웨어 버전을 출력한다.

### 워크플로우 파일 시각화
이 다이어그램에서는 방금 생성한 워크플로우 파일과 GitHub Actions 구성 요소가 계층적으로 어떻게 조직되어 있는지 볼 수 있다. 각 단계는 하나의 액션 또는 쉘 스크립트를 실행한다. 1단계와 2단계는 액션을 실행하고, 3단계와 4단계는 쉘 스크립트를 실행한다. 

### 워크플로우 실행 기록 보기
워크플로우가 트리거되면 워크플로우 실행이 생성되어 워크플로우를 실행한다. 워크플로우 실행이 시작되면 실행의 진행 상황을 시각적으로 볼 수 있으며, 각 단계의 활동을 GitHub에서 볼 수 있다.

1. GitHub.com에서 저장소의 메인 페이지로 이동한다.

2. 저장소 이름 아래에서 "Actions" 탭을 클릭한다.

3. 왼쪽 사이드바에서 보고 싶은 워크플로우를 클릭한다.

4. 워크플로우 실행 목록에서 실행 이름을 클릭하여 워크플로우 실행 요약을 본다.

5. 왼쪽 사이드바 또는 시각화 그래프에서 보고 싶은 작업을 클릭한다.

6. 단계의 결과를 보려면 단계를 클릭한다.